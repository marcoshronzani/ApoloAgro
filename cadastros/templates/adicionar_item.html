{% extends 'base.html'%}

{% block 'titulo' %} Adiciona Item {% endblock %}

{%block 'conteudo' %}
<div class="container">
    <div style="text-align: center">
        <br>

        <h2>Cadastrar Orçamento</h2>

        {% if messages %}
            {% for message in messages %}
                <div class="alert {{message.tags}}">{{message}}</div>
            {% endfor %}
        {% endif %}

    </div>
    
        <br>
        <div class="form row">
            <div class="form-group col-md-5">
                <label for="situacao">Situação:</label>
                <select name="situacao" class="form-control" id="situacao" readonly>
                    {% for orc in orcamento.choice %}
                        {% if orcamento.situacao == orc.0 %}
                            <option value="{{orc.0}}" selected>{{ orc.1 }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
            <div class="form row form.group col-md-3" >
                <p>Criado em: {{orcamento.data_criacao}}</p>
            </div>
        </div>
        <br>
        <div class="form row">
            <div class="form-group col-md-5">
                <label for="cliente">Cliente:</label>
                <select name="cliente" class="form-control" id="cliente" readonly>
                    {% for cli in clientes %}
                        {% if orcamento.cliente == cli %}
                            <option value="{{cli.id}}">{% if cli.razao_social %}{{ cli.razao_social }}{% else %}{{ cli.nome_completo }}{% endif %}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
            <div class="form-group col-md-5">
                <label for="terceiro">Terceiro:</label>
                <select name="terceiro" class="form-control" id="terceiro" readonly>
                    {% for terc in terceiros %}
                        {% if orcamento.terceiro == terc %}
                            <option value="{{terc.id}}">{% if terc.razao_social %}{{ terc.razao_social }}{% else %}{{ terc.nome_completo }}{% endif %}</option>
                        {% endif %}
                    {% endfor %}
                </select>
            </div>
        </div>
        <br>
        <div class="form-row">
            <div class="form-group col-md-10">
                <label for="observacao">Observação:</label>
                <textarea class="form-control" id="observacao" name="observacao"
                    rows="3" readonly>{{ orcamento.observacao }}</textarea>
            </div>
        </div>
        <br>
        <div class="form-inline">
            <div class="form-group col-md-3">
                <label form="valorTotal">Valor Total:</label>&nbsp
                <input class="form-control" type="text" id="valorTotal" name="valorTotal" style="width: 40%" value="{{ orcamento.valor_total }}" readonly>
            </div>
            <div class="form-group col-md-2">
                <label form="desconto">Desconto:</label>&nbsp
                <input class="form-control" type="text" id="desconto" name="desconto" style="width: 40%" value="{{ orcamento.desconto }}" readonly>
            </div>
            <div class="form-group col-md-3">
                <label form="valorDesconto">Valor com Desconto:</label>&nbsp
                <input class="form-control" type="text" id="valorDesconto" name="valorDesconto" style="width: 35%" value="{{ orcamento.valor_desconto }}" readonly>
            </div>
            <div class="form-group col-md-2">
            </div>
        </div>
        <br>
        <hr>

        <div style="text-align: center">
            <h3>Adiciona Itens</h3>
        </div>
        <br>

        <div class="form-row">
            <form action="" method="GET">
                <div class="form-group col-md-10">
                    <input class="form-control-sm" type="search" id="search-input" placeholder="Pesquisar" name="termo"
                    value="{{ request.GET.termo }}" title="Digite o produto">

                    <input hidden name="id_orcamento" value="{{orcamento.id}}">
                </div>
            </form>
        </div>
                            <!-- Botão para acionar modal -->
                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#ModalLongoExemplo">
                                Abrir modal de demonstração
                           </button>

    <form method="POST">{% csrf_token %}
        <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col">Descrição</th></th>
                <th scope="col">Quantidade</th>
                <th scope="col">Desconto</th>
                <th scope="col">Valor</th>
              </tr>
            </thead>
            <tbody>
            {% for produto in produtos %}
              <tr>
                <th scope="row">{{ produto.descricao }}</th>
                <td>{{ produto.quantidade }}</td>
                <td>{{ produto.desconto }}</td>
                <td>{{ produto.valor }}</td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        <br>
        <input class="btn btn-success btn-sm" type="Submit" value="Salvar">&nbsp&nbsp&nbsp 
        <a href="{% url 'orcamentos' %}" class="btn btn-primary btn-sm">Cancelar</a>
    </form>
</div>

{% endblock %}